{% extends "base.html" %}
{% load django_bootstrap5 %}
{% bootstrap_messages %}
{% load i18n %}

{% block content %}
<div class="container py-3 py-lg-4">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8">

            <form method="post" class="h-100 d-flex flex-column">
                {% csrf_token %}

                <!-- –ë–ª–æ–∫ –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–ö–æ–Ω—Ç–µ–∫—Å—Ç) -->
                <div class="card border-0 shadow-sm mb-3 bg-light">
                    <div class="card-body py-2 px-3">
                        <!-- –í–µ—Ä—Ö–Ω—è—è —Å—Ç—Ä–æ–∫–∞: –¥–∞—Ç–∞/–≤—Ä–µ–º—è -->
                        <div class="d-flex justify-content-between small mb-2">
                            <span class="text-muted" title="{% trans 'Created' %}">üìÖ {{ object.created_at|date:"d.m H:i" }}</span>
                        </div>
                        <!-- –°—Ä–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞: —Å—Ç–∞—Ç—É—Å (—Å–ª–µ–≤–∞), –º–µ—Ç–∫–∏ (—Å–ø—Ä–∞–≤–∞) -->
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <span class="badge border bg-white" style="color: {{ object.status.color|default:'#6c757d' }}; border-color: {{ object.status.color|default:'#dee2e6' }} !important;">
                                {{ object.status.name }}
                            </span>
                            {% if object.labels.all %}
                            <div class="d-flex flex-wrap gap-1 justify-content-end">
                                {% for label in object.labels.all %}
                                <span class="badge bg-light text-secondary border fw-normal" title="{{ label.name }}">{{ label.name }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                        <!-- –ù–∏–∂–Ω—è—è —Å—Ç—Ä–æ–∫–∞: –∞–≤—Ç–æ—Ä (—Å–ª–µ–≤–∞), –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (—Å–ø—Ä–∞–≤–∞) -->
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center fw-bold text-dark border rounded px-2 py-1 bg-white" title="{% trans 'Author' %}">
                                <span class="me-1">üë§</span> {{ object.author.username }}
                            </div>
                            {% if object.executors.all %}
                            <div class="d-flex align-items-center gap-1">
                                {% for executor in object.executors.all %}
                                <div class="d-flex align-items-center fw-bold text-dark border rounded px-2 py-1 bg-white" title="{% trans 'Executor' %}">
                                    <span class="me-1">üëâ</span> {{ executor.username }}
                                </div>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (–ö–æ–Ω—Ç–µ–Ω—Ç) -->
                <div class="card shadow border-0 mb-4">
                    <div class="card-body p-3 p-md-4">
                        {% bootstrap_form form %}
                    </div>
                </div>

                <!-- –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π (Action Bar) -->
                <div class="d-grid gap-2 d-md-flex align-items-md-center justify-content-md-between mb-5">

                    <div class="d-grid gap-2 d-md-flex">
                        <button type="submit" class="btn btn-primary px-md-4 py-2 fw-bold">
                            {% trans "Edit" %}
                        </button>
                        <a class="btn btn-outline-secondary px-md-4 py-2" href="{% url 'tasks:tasks-list' %}">
                            {% trans "Cancel" %}
                        </a>
                    </div>

                    <a class="btn btn-link text-danger text-decoration-none mt-2 mt-md-0" href="{% url 'tasks:task-delete' object.uuid %}">
                        <small>üóëÔ∏è {% trans "Delete" %}</small>
                    </a>
                </div>

            </form>
        </div>
    </div>
</div>

<style>
    textarea.form-control {
        min-height: 200px;
        background-color: #fcfcfc;
        line-height: 1.6;
    }

    input[name="name"] {
        font-weight: 700;
        font-size: 1.25rem;
        padding: 0.75rem;
    }

    label.form-label {
        color: #6c757d;
        font-size: 0.85rem;
        margin-bottom: 0.2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
</style>
{% endblock %}